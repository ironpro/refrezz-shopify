/**
 *  @class
 *  @function SidePanelLinks
 */
if (!customElements.get('side-panel-links')) {
  class SidePanelLinks extends HTMLElement {
    constructor() {
      super();
      this.links = this.querySelectorAll('button');
      this.body = document.body;
    }
    connectedCallback() {
      this.cc = document.querySelector('.click-capture');
      this.wrapper = document.getElementById('wrapper');
      this.drawer = document.getElementById('Product-Information-Drawer');
      this.close = this.drawer.querySelector('.thb-close');
      this.headings = this.drawer.querySelectorAll('.side-panel--heading');
      this.panels = this.drawer.querySelectorAll('.side-panel-content--tab-panel');

      this.setupObservers();
      this.setupAnimation();
    }
    setupObservers() {
      this.links.forEach((item, i) => {
        item.addEventListener('click', (e) => {
          this.toggleActiveClass(i);
          this.tl.play();
        });
      });
      this.cc.addEventListener('click', this.closeDrawer.bind(this));
      this.close.addEventListener('click', this.closeDrawer.bind(this));
    }
    setupAnimation() {
      this.tl = gsap.timeline({
        paused: true,
        onStart: () => {
          this.wrapper.classList.add('open-cc');
          gsap.set(this.drawer, {
            visibility: "visible"
          });
        },
        onReverseComplete: () => {
          this.wrapper.classList.remove('open-cc');
          gsap.set(this.drawer, {
            clearProps: "transform"
          });
          this.blur();
        },
        onComplete: () => {
          this.focus();
        }
      });
      this.tl
        .to(this.drawer, {
          x: "0%",
          duration: 0.25
        }, "start");
    }
    closeDrawer() {
      this.tl.timeScale(1.5).reverse();
    }
    toggleActiveClass(i) {
      this.panels.forEach((panel) => {
        panel.classList.remove('tab-active');
      });
      this.headings.forEach((heading) => {
        heading.classList.remove('tab-active');
      });
      this.panels[i].classList.add('tab-active');
      this.headings[i].classList.add('tab-active');
    }
  }

  customElements.define('side-panel-links', SidePanelLinks);
}